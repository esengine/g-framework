window.gs.physics={};var __values=this&&this.__values||function(t){var o="function"==typeof Symbol&&t[Symbol.iterator],i=0;return o?o.call(t):{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}}};window.__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var i in o)o.hasOwnProperty(i)&&(t[i]=o[i])};return function(o,i){function n(){this.constructor=o}t(o,i),o.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();var gs,__read=this&&this.__read||function(t,o){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var n,e,r=i.call(t),s=[];try{for(;(void 0===o||o-- >0)&&!(n=r.next()).done;)s.push(n.value)}catch(t){e={error:t}}finally{try{n&&!n.done&&(i=r.return)&&i.call(r)}finally{if(e)throw e.error}}return s},__spread=this&&this.__spread||function(){for(var t=[],o=0;o<arguments.length;o++)t=t.concat(__read(arguments[o]));return t};!function(t){!function(t){var o=function(){function o(t,o){this.shape1=t,this.shape2=o}return o.prototype.epa=function(){for(var o,i,n=[];;){var e=n[0];try{for(var r=__values(n),s=r.next();!s.done;s=r.next()){var a=s.value;a.distance.lt(e.distance)&&(e=a)}}catch(t){o={error:t}}finally{try{s&&!s.done&&(i=r.return)&&i.call(r)}finally{if(o)throw o.error}}var l=e.pointB.sub(e.pointA).perp(),h=this.support(l);if(h.sub(e.pointA).dot(l).lte(0)||h.distanceTo(t.Vector2.zero()).sub(e.distance).lte(0))return l.mul(e.distance);this.addPointToPolytope(n,h)}},o.prototype.gjk=function(){var o=new t.Vector2(1,0),i=new t.Simplex;for(i.add(this.support(o)),t.Vector2.negate(o);;){if(i.add(this.support(o)),i.vertices[0].dot(o).toFloat()<=0)return!1;if(this.updateSimplexAndDirection(i,o))return!0}},o.prototype.updateSimplexAndDirection=function(t,o){if(2===t.vertices.length){var i=t.vertices[1],n=(e=t.vertices[0]).negate();(s=i.sub(e)).cross(n).gt(0)?o.setR(s.perp().negate()):o.setR(s.perp())}else if(3===t.vertices.length){var e,r=t.vertices[2],s=(i=t.vertices[1],n=(e=t.vertices[0]).negate(),i.sub(e)),a=r.sub(e);s.cross(a);if(s.cross(n).gt(0))t.vertices.splice(2,1),o.setR(s.perp().negate());else{if(!a.cross(n).gt(0))return!0;t.vertices.splice(1,1),o.setR(a.perp())}}return!1},o.prototype.addPointToPolytope=function(o,i){for(var n,e,r,s,a=[],l=0;l<o.length;l++){var h=(f=o[l]).pointA,u=f.pointB.sub(h),c=i.sub(h);u.cross(c).gt(0)&&a.push(f)}try{for(var d=__values(a),p=d.next();!p.done;p=d.next()){var f=p.value,y=o.indexOf(f);-1!==y&&o.splice(y,1)}}catch(t){n={error:t}}finally{try{p&&!p.done&&(e=d.return)&&e.call(d)}finally{if(n)throw n.error}}try{for(var v=__values(a),x=v.next();!x.done;x=v.next()){f=x.value;o.push(new t.Edge(f.point1,i)),o.push(new t.Edge(i,f.point2))}}catch(t){r={error:t}}finally{try{x&&!x.done&&(s=v.return)&&s.call(v)}finally{if(r)throw r.error}}},o.prototype.support=function(t){var o=this.shape1.getFarthestPointInDirection(t),i=this.shape2.getFarthestPointInDirection(t.negate());return o.sub(i)},o}();t.PolygonCollisionDetector=o}(t.physics||(t.physics={}))}(gs||(gs={})),function(t){!function(o){var i=function(t){function i(o,i,n,e){var r=t.call(this,o)||this;return r.entity1=i,r.entity2=n,r.velocities=e,r}return __extends(i,t),i.prototype.reset=function(){t.prototype.reset.call(this),this.entity1=null,this.entity2=null,this.velocities={v1:new o.Vector2(0,0),v2:new o.Vector2(0,0)}},i.prototype.getEntity1=function(){return this.entity1},i.prototype.getEntity2=function(){return this.entity2},i.prototype.getVelocities=function(){return this.velocities},i}(t.Event);o.CollisionEvent=i}(t.physics||(t.physics={}))}(gs||(gs={})),function(t){!function(o){var i=function(i){function n(n,e){var r=i.call(this,n,0,t.Matcher.empty().all(o.RigidBody,o.Collider,o.Transform))||this;return r.processed=new Map,r.collisionPairs=[],r.dynamicTree=new o.DynamicTree,r.updateInterval=e,r}return __extends(n,i),n.prototype.update=function(t){this.resetForNewFrame();var o=this.initializeNodesAndEntities(t);this.processCollisions(o)},n.prototype.resetForNewFrame=function(){this.dynamicTree.clear(),this.processed.clear(),this.collisionPairs.length=0},n.prototype.initializeNodesAndEntities=function(i){var n,e,r=new Map,s=t.TimeManager.getInstance().deltaTime,a=[];try{for(var l=__values(i),h=l.next();!h.done;h=l.next()){var u=h.value,c=u.getComponent(o.Collider),d=u.getComponent(o.RigidBody),p=u.getComponent(o.Transform);d&&!d.isKinematic&&d.update(s),d.lastPosition=p.position;var f={children:[],height:0,leaf:!0,bounds:c.getBounds()};a.push(f),r.set(f,u)}}catch(t){n={error:t}}finally{try{h&&!h.done&&(e=l.return)&&e.call(l)}finally{if(n)throw n.error}}return this.dynamicTree.load(a),r},n.prototype.processCollisions=function(t){var o,i,n,e,r=new Set;try{for(var s=__values(t.keys()),a=s.next();!a.done;a=s.next()){var l=a.value,h=t.get(l),u=h.getId(),c=this.processed.get(u);c||(c=new Set,this.processed.set(u,c));var d=this.dynamicTree.search(l.bounds);try{for(var p=__values(d),f=p.next();!f.done;f=p.next()){var y=f.value,v=t.get(y),x=v.getId();if(u!==x){var g=u<x?u+","+x:x+","+u;r.has(g)||(this.collisionPairs.push([h,v]),r.add(g))}}}catch(t){n={error:t}}finally{try{f&&!f.done&&(e=p.return)&&e.call(p)}finally{if(n)throw n.error}}}}catch(t){o={error:t}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(o)throw o.error}}this.resolveCollisions()},n.prototype.resolveCollisions=function(){var t,i,n=new o.FixedPoint(.8);try{for(var e=__values(this.collisionPairs),r=e.next();!r.done;r=e.next()){var s=__read(r.value,2),a=s[0],l=s[1],h=a.getComponent(o.Collider),u=l.getComponent(o.Collider),c=a.getComponent(o.RigidBody),d=l.getComponent(o.RigidBody);if(c&&!c.isKinematic&&d&&!d.isKinematic){var p=h.calculatePenetrationDepthAndNormal(u),f=p.penetrationDepth,y=p.collisionNormal;f&&y&&(this.resolvePBD(c,d,f,y,n),this.resolveDynamicCollision(c,d,y))}h.handleCollision(l),u.handleCollision(a)}}catch(o){t={error:o}}finally{try{r&&!r.done&&(i=e.return)&&i.call(e)}finally{if(t)throw t.error}}this.handleCollisionExits()},n.prototype.handleCollisionExits=function(){var t,i,n,e,r,s;try{for(var a=__values(this.processed.values()),l=a.next();!l.done;l=a.next()){var h=l.value;try{for(var u=__values(h),c=u.next();!c.done;c=u.next()){var d=c.value,p=this.entityManager.getEntity(d),f=p.getComponent(o.Collider);try{for(var y=__values(f.collidingEntities),v=y.next();!v.done;v=y.next()){var x=v.value;h.has(x.getId())||(f.handleCollisionExit(x),x.getComponent(o.Collider).handleCollisionExit(p))}}catch(t){r={error:t}}finally{try{v&&!v.done&&(s=y.return)&&s.call(y)}finally{if(r)throw r.error}}}}catch(t){n={error:t}}finally{try{c&&!c.done&&(e=u.return)&&e.call(u)}finally{if(n)throw n.error}}}}catch(o){t={error:o}}finally{try{l&&!l.done&&(i=a.return)&&i.call(a)}finally{if(t)throw t.error}}},n.prototype.resolveDynamicCollision=function(t,i,n){var e=t.velocity.dot(n),r=i.velocity.dot(n),s=o.FixedPoint.div(o.FixedPoint.add(o.FixedPoint.mul(e,o.FixedPoint.sub(t.mass,i.mass)),o.FixedPoint.mul(o.FixedPoint.mul(new o.FixedPoint(2),i.mass),r)),o.FixedPoint.add(t.mass,i.mass)),a=o.FixedPoint.div(o.FixedPoint.add(o.FixedPoint.mul(r,o.FixedPoint.sub(i.mass,t.mass)),o.FixedPoint.mul(o.FixedPoint.mul(new o.FixedPoint(2),t.mass),e)),o.FixedPoint.add(t.mass,i.mass));t.velocity=t.velocity.add(n.mul(o.FixedPoint.sub(s,e))),i.velocity=i.velocity.add(n.mul(o.FixedPoint.sub(a,r)))},n.prototype.resolvePBD=function(t,i,n,e,r){var s=e.mul(n.mul(r)),a=o.FixedPoint.add(t.mass,i.mass);t.transform.position=t.transform.position.sub(s.mul(o.FixedPoint.div(t.mass,a))),i.transform.position=i.transform.position.add(s.mul(o.FixedPoint.div(i.mass,a)))},n}(t.System);o.CollisionResponseSystem=i}(t.physics||(t.physics={}))}(gs||(gs={})),function(t){!function(t){function o(o,n,e,r,s){s||(s=i(null)),s.bounds=new t.BoxBounds(t.Vector2.zero(),new t.FixedPoint,new t.FixedPoint,null);for(var a=t.FixedPoint.from(1/0),l=t.FixedPoint.from(1/0),h=t.FixedPoint.from(-1/0),u=t.FixedPoint.from(-1/0),c=n;c<e;c++){var d=r(o.children[c]);a=t.FixedPoint.min(a,d.position.x),l=t.FixedPoint.min(l,d.position.y),h=t.FixedPoint.max(h,d.position.x.add(d.width)),u=t.FixedPoint.max(u,d.position.y.add(d.height))}var p=new t.BoxBounds(new t.Vector2(a.toFloat(),l.toFloat()),h.sub(a),u.sub(l),s.bounds.entity);return s.bounds=p,s}function i(o){return{children:o,height:1,leaf:!0,bounds:new t.BoxBounds(t.Vector2.zero(),new t.FixedPoint,new t.FixedPoint,null)}}function n(t,o,i,r,s){for(;r>i;){if(r-i>600){var a=r-i+1,l=o-i+1,h=Math.log(a),u=.5*Math.exp(2*h/3),c=.5*Math.sqrt(h*u*(a-u)/a)*Math.sign(l-a/2);n(t,o,Math.max(i,Math.floor(o-l*u/a+c)),Math.min(r,Math.floor(o+(a-l)*u/a+c)),s)}var d=t[o],p=i,f=r;for(e(t,i,o),s(t[r],d).gt(0)&&e(t,i,r);p<f;){for(e(t,p,f),p++,f--;s(t[p],d).lt(0);)p++;for(;s(t[f],d).gt(0);)f--}s(t[i],d).equals(0)?e(t,i,f):e(t,++f,r),f<=o&&(i=f+1),o<=f&&(r=f-1)}}function e(t,o,i){var n=t[o];t[o]=t[i],t[i]=n}t.findItem=function(t,o,i){if(!i)return o.indexOf(t);for(var n=0;n<o.length;n++)if(i(t,o[n]))return n;return-1},t.calcBounds=function(t,i){o(t,0,t.children.length,i,t)},t.distBounds=o,t.extend=function(o,i){var n=t.FixedPoint.min(o.position.x,i.position.x),e=t.FixedPoint.min(o.position.y,i.position.y),r=t.FixedPoint.max(o.position.x.add(o.width),i.position.x.add(i.width)),s=t.FixedPoint.max(o.position.y.add(o.height),i.position.y.add(i.height));return o.position.x=n,o.position.y=e,o.width=r.sub(n),o.height=s.sub(e),o},t.compareNodeMinX=function(t,o){return t.bounds.position.x.sub(o.bounds.position.x)},t.compareNodeMinY=function(t,o){return t.bounds.position.y.sub(o.bounds.position.y)},t.boundsArea=function(t){var o=t.bounds;return o.width.mul(o.height)},t.boundsMargin=function(t){var o=t.bounds;return o.width.add(o.height)},t.enlargedArea=function(o,i){return t.FixedPoint.max(i.position.x.add(i.width),o.position.x.add(o.width)).sub(t.FixedPoint.min(i.position.x,o.position.x)).mul(t.FixedPoint.max(i.position.y.add(i.height),o.position.y.add(o.height)).sub(t.FixedPoint.min(i.position.y,o.position.y)))},t.intersectionArea=function(o,i){var n=t.FixedPoint.max(o.position.x,i.position.x),e=t.FixedPoint.max(o.position.y,i.position.y),r=t.FixedPoint.min(o.position.x.add(o.width),i.position.x.add(i.width)),s=t.FixedPoint.min(o.position.y.add(o.height),i.position.y.add(i.height));return t.FixedPoint.max(t.FixedPoint.from(0),r.sub(n)).mul(t.FixedPoint.max(t.FixedPoint.from(0),s.sub(e)))},t.createNode=i,t.multiSelect=function(t,o,i,e,r){for(var s=[o,i];s.length;)if(!((i=s.pop())-(o=s.pop())<=e)){var a=o+Math.ceil((i-o)/e/2)*e;n(t,a,o,i,r),s.push(o,a,a,i)}},t.quickselect=n,t.swap=e}(t.physics||(t.physics={}))}(gs||(gs={})),function(t){!function(t){var o=function(){function o(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}return o.prototype.compareMinX=function(t,o){return t.bounds.position.x.sub(o.bounds.position.x)},o.prototype.compareMinY=function(t,o){return t.bounds.position.y.sub(o.bounds.position.y)},o.prototype.all=function(){return this._all(this.data,[])},o.prototype.search=function(t){var o=this.data,i=[];if(!t.intersects(o.bounds))return i;for(var n=[];o;){for(var e=0;e<o.children.length;e++){var r=o.children[e];t.intersects(r.bounds)&&(o.leaf?i.push(r):t.contains(r.bounds)?this._all(r,i):n.push(r))}o=n.pop()}return i},o.prototype.collides=function(t){var o=this.data;if(!t.intersects(o.bounds))return!1;for(var i=[];o;){for(var n=0;n<o.children.length;n++){var e=o.children[n];if(t.intersects(e.bounds)){if(o.leaf||t.contains(e.bounds))return!0;i.push(e)}}o=i.pop()}return!1},o.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var o=0;o<t.length;o++)this.insert(t[o]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var n=this.data;this.data=i,i=n}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},o.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},o.prototype.clear=function(){return this.data=t.createNode([]),this},o.prototype.remove=function(o,i){if(!o)return this;for(var n,e,r,s=this.data,a=(o.bounds,[]),l=[];s||a.length;){if(s||(s=a.pop(),e=a[a.length-1],n=l.pop(),r=!0),s.leaf){var h=t.findItem(o,s.children,i);if(-1!==h)return s.children.splice(h,1),a.push(s),this._condense(a),this}r||s.leaf||!o.bounds.contains(s.bounds)?e?(n++,s=e.children[n],r=!1):s=null:(a.push(s),l.push(n),n=0,e=s,s=s.children[0])}return this},o.prototype.toBounds=function(t){return t.bounds},o.prototype.toJSON=function(){return this.data},o.prototype.fromJSON=function(t){return this.data=t,this},o.prototype._all=function(t,o){for(var i=[];t;)t.leaf?o.push.apply(o,__spread(t.children)):i.push.apply(i,__spread(t.children)),t=i.pop();return o},o.prototype._build=function(o,i,n,e){var r,s=n-i+1,a=this._maxEntries;if(s<=a)return r=t.createNode(o.slice(i,n+1)),t.calcBounds(r,this.toBounds),r;e||(e=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,e-1))),(r=t.createNode([])).leaf=!1,r.height=e;var l=Math.ceil(s/a),h=l*Math.ceil(Math.sqrt(a));t.multiSelect(o,i,n,h,this.compareMinX);for(var u=i;u<=n;u+=h){var c=Math.min(u+h-1,n);t.multiSelect(o,u,c,l,this.compareMinY);for(var d=u;d<=c;d+=l){var p=Math.min(d+l-1,c);r.children.push(this._build(o,d,p,e-1))}}return t.calcBounds(r,this.toBounds),r},o.prototype._chooseSubtree=function(o,i,n,e){for(;e.push(i),!i.leaf&&e.length-1!==n;){for(var r=new t.FixedPoint(1/0),s=new t.FixedPoint(1/0),a=void 0,l=0;l<i.children.length;l++){var h=i.children[l],u=t.boundsArea(h),c=t.enlargedArea(o,h.bounds).sub(u);c.lt(s)?(s=c,r=u<r?u:r,a=h):c===s&&u<r&&(r=u,a=h)}i=a||i.children[0]}return i},o.prototype._insert=function(o,i,n){var e=o.bounds,r=[],s=this._chooseSubtree(o.bounds,this.data,i,r);for(s.children.push(o),t.extend(s.bounds,e);i>=0&&r[i].children.length>this._maxEntries;)this._split(r,i),i--;this._adjustParentBounds(e,r,i)},o.prototype._split=function(o,i){var n=o[i],e=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,e);var s=this._chooseSplitIndex(n,r,e),a=t.createNode(n.children.splice(s,n.children.length-s));a.height=n.height,a.leaf=n.leaf,t.calcBounds(n,this.toBounds),t.calcBounds(a,this.toBounds),i?o[i-1].children.push(a):this._splitRoot(n,a)},o.prototype._splitRoot=function(o,i){this.data=t.createNode([o,i]),this.data.height=o.height+1,this.data.leaf=!1,t.calcBounds(this.data,this.toBounds)},o.prototype._chooseSplitIndex=function(o,i,n){for(var e,r=new t.FixedPoint(1/0),s=new t.FixedPoint(1/0),a=i;a<=n-i;a++){var l=t.distBounds(o,0,a,this.toBounds),h=t.distBounds(o,a,n,this.toBounds),u=t.intersectionArea(l.bounds,h.bounds),c=t.boundsArea(l).add(t.boundsArea(h));u.lt(r)?(r=u,e=a,s=c<s?c:s):u===r&&c<s&&(s=c,e=a)}return e||n-i},o.prototype._chooseSplitAxis=function(o,i,n){var e=o.leaf?this.compareMinX:t.compareNodeMinX,r=o.leaf?this.compareMinY:t.compareNodeMinY;this._allDistMargin(o,i,n,function(t,o){return e(t,o).toFloat()})<this._allDistMargin(o,i,n,function(t,o){return r(t,o).toFloat()})&&o.children.sort(function(t,o){return e(t,o).toFloat()})},o.prototype._allDistMargin=function(o,i,n,e){o.children.sort(e);for(var r=this.toBounds,s=t.distBounds(o,0,i,r),a=t.distBounds(o,n-i,n,r),l=t.boundsMargin(s).add(t.boundsMargin(a)),h=i;h<n-i;h++){var u=o.children[h];t.extend(s.bounds,o.leaf?r(u):u.bounds),l=l.add(t.boundsMargin(s))}for(h=n-i-1;h>=i;h--){u=o.children[h];t.extend(a.bounds,o.leaf?r(u):u.bounds),l=l.add(t.boundsMargin(a))}return l},o.prototype._adjustParentBounds=function(o,i,n){for(var e=n;e>=0;e--)t.extend(i[e].bounds,o)},o.prototype._condense=function(o){for(var i=o.length-1,n=void 0;i>=0;i--)0===o[i].children.length?i>0?(n=o[i-1].children).splice(n.indexOf(o[i]),1):this.clear():t.calcBounds(o[i],this.toBounds)},o}();t.DynamicTree=o}(t.physics||(t.physics={}))}(gs||(gs={})),function(t){!function(t){var o=function(){return function(t,o){this.pointA=t,this.pointB=o;var i=o.sub(t),n=t.negate();this.distance=i.cross(n).div(i.length())}}();t.Edge=o}(t.physics||(t.physics={}))}(gs||(gs={})),function(t){!function(t){var o=function(){function t(t,o){void 0===t&&(t=0),void 0===o&&(o=1e3),this.rawValue=Math.round(t*o),this.precision=o}return Object.defineProperty(t,"MAX_VALUE",{get:function(){return new t(Number.MAX_VALUE)},enumerable:!0,configurable:!0}),t.prototype.add=function(o){return o instanceof t?t.fromRawValue(this.rawValue+o.rawValue,this.precision):t.fromRawValue(this.rawValue+Math.round(o*this.precision),this.precision)},t.prototype.sub=function(o){var i=new t(0,this.precision);return i.rawValue=o instanceof t?this.rawValue-o.rawValue:this.rawValue-Math.round(o*this.precision),i},t.prototype.mul=function(o){var i=new t(0,this.precision);return i.rawValue=o instanceof t?Math.round(this.rawValue*o.rawValue/this.precision):Math.round(this.rawValue*o),i},t.prototype.div=function(o){var i=new t(0,this.precision);return i.rawValue=o instanceof t?Math.round(this.rawValue*this.precision/o.rawValue):Math.round(this.rawValue/o),i},t.prototype.abs=function(){var o=new t(0,this.precision);return o.rawValue=Math.abs(this.rawValue),o},t.prototype.pow=function(o){var i=Math.pow(this.toFloat(),o);return t.from(i)},t.prototype.equals=function(o){return o instanceof t?this.rawValue===o.rawValue:this.rawValue===Math.round(o*this.precision)},t.prototype.lt=function(o){return o instanceof t?this.rawValue<o.rawValue:this.rawValue<Math.round(o*this.precision)},t.prototype.gt=function(o){return o instanceof t?this.rawValue>o.rawValue:this.rawValue>Math.round(o*this.precision)},t.prototype.gte=function(o){return o instanceof t?this.rawValue>=o.rawValue:this.rawValue>=Math.round(o*this.precision)},t.prototype.lte=function(o){return o instanceof t?this.rawValue<=o.rawValue:this.rawValue<=Math.round(o*this.precision)},t.prototype.isPositive=function(){return this.rawValue>0},t.prototype.negate=function(){return t.fromRawValue(-this.rawValue,this.precision)},t.prototype.toFloat=function(){return this.rawValue/this.precision},t.prototype.toFixed=function(t){return void 0===t&&(t=0),this.toFloat().toFixed(t)},t.prototype.sqrt=function(){return t.from(Math.sqrt(this.toFloat()))},t.prototype.round=function(){return t.from(Math.round(this.toFloat()))},t.prototype.clamp=function(o,i){var n,e;return n=o instanceof t?o.rawValue:Math.round(o*this.precision),e=i instanceof t?i.rawValue:Math.round(i*this.precision),this.rawValue<n?t.fromRawValue(n,this.precision):this.rawValue>e?t.fromRawValue(e,this.precision):this},t.clamp=function(t,o,i){return t.clamp(o,i)},t.add=function(t,o){return t.add(o)},t.sub=function(t,o){return t.sub(o)},t.mul=function(t,o){return t.mul(o)},t.div=function(t,o){return t.div(o)},t.max=function(t,o){return t.gt(o)?t:o},t.min=function(t,o){return t.lt(o)?t:o},t.fromRawValue=function(o,i){void 0===i&&(i=1e3);var n=new t(0,i);return n.rawValue=o,n},t.from=function(o,i){return void 0===i&&(i=1e3),new t(o,i)},t}();t.FixedPoint=o}(t.physics||(t.physics={}))}(gs||(gs={})),function(t){!function(t){var o=function(){function t(t,o){this.min=t,this.max=o}return t.prototype.overlaps=function(t){return this.max>=t.min&&this.min<=t.max},t}();t.Projection=o}(t.physics||(t.physics={}))}(gs||(gs={})),function(t){!function(o){var i=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.dependencies=[o.Transform],i}return __extends(i,t),Object.defineProperty(i.prototype,"transform",{get:function(){return this._transform||(this._transform=this.entity.getComponent(o.Transform)),this._transform},enumerable:!0,configurable:!0}),i.prototype.onInitialize=function(t,i){void 0===t&&(t=new o.FixedPoint(1)),void 0===i&&(i=!1),this.mass=t,this.velocity=new o.Vector2,this.acceleration=new o.Vector2,this.isKinematic=i,this.restitution=new o.FixedPoint(1),this.inv_mass=this.mass.equals(0)?o.FixedPoint.MAX_VALUE:new o.FixedPoint(1).div(this.mass),this.lastPosition=this.transform.position},i.prototype.applyForce=function(t){var i=new o.Vector2(t.x.div(this.mass),t.y.div(this.mass));this.acceleration=this.acceleration.add(i)},i.prototype.update=function(t){this.velocity=this.velocity.add(this.acceleration.mul(t)),this.lastPosition=this.transform.position,this.transform.position=this.transform.position.add(this.velocity.mul(t)),this.acceleration.set(new o.FixedPoint(0),new o.FixedPoint(0))},i}(t.Component);o.RigidBody=i}(t.physics||(t.physics={}))}(gs||(gs={})),function(t){!function(t){var o=function(){function t(){this.vertices=[]}return t.prototype.add=function(t){this.vertices.unshift(t)},t}();t.Simplex=o}(t.physics||(t.physics={}))}(gs||(gs={})),function(t){!function(t){var o=function(){function o(o,i){void 0===o&&(o=0),void 0===i&&(i=0),this.width=new t.FixedPoint(o),this.height=new t.FixedPoint(i)}return o.prototype.add=function(t){return new o(this.width.toFloat()+t.width.toFloat(),this.height.toFloat()+t.height.toFloat())},o.prototype.subtract=function(t){return new o(this.width.toFloat()-t.width.toFloat(),this.height.toFloat()-t.height.toFloat())},o.prototype.multiply=function(t){return new o(this.width.toFloat()*t,this.height.toFloat()*t)},o.prototype.divide=function(t){return new o(this.width.toFloat()/t,this.height.toFloat()/t)},o}();t.Size=o}(t.physics||(t.physics={}))}(gs||(gs={})),function(t){!function(t){var o=function(){function t(t){this.setPool=[],this.cellSize=t,this.hashTable=new Map,this.objectTable=new Map}return t.prototype.hash=function(t,o){return 73856093*t^19349663*o},t.prototype.getSetFromPool=function(){return this.setPool.length>0?this.setPool.pop():new Set},t.prototype.returnSetToPool=function(t){t.clear(),this.setPool.push(t)},t.prototype.insert=function(t){for(var o=Math.floor(t.position.x.toFloat()/this.cellSize),i=Math.floor(t.position.y.toFloat()/this.cellSize),n=Math.floor((t.position.x.toFloat()+t.width.toFloat())/this.cellSize),e=Math.floor((t.position.y.toFloat()+t.height.toFloat())/this.cellSize),r=[],s=o;s<=n;s++)for(var a=i;a<=e;a++){var l=this.hash(s,a);r.push(l);var h=this.hashTable.get(l);h||(h=this.getSetFromPool(),this.hashTable.set(l,h)),h.add(t)}this.objectTable.set(t,r)},t.prototype.retrieve=function(t,o){var i,n,e,r,s=this.objectTable.get(t);if(s)try{for(var a=__values(s),l=a.next();!l.done;l=a.next()){var h=l.value,u=this.hashTable.get(h);if(u)try{for(var c=__values(u),d=c.next();!d.done;d=c.next()){o(d.value)}}catch(t){e={error:t}}finally{try{d&&!d.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}}}catch(t){i={error:t}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}},t.prototype.retrieveAll=function(){var t,o,i=[];try{for(var n=__values(this.hashTable.values()),e=n.next();!e.done;e=n.next()){var r=e.value;i.push.apply(i,__spread(r))}}catch(o){t={error:o}}finally{try{e&&!e.done&&(o=n.return)&&o.call(n)}finally{if(t)throw t.error}}return i},t.prototype.remove=function(t){var o,i,n=this.objectTable.get(t);if(n){try{for(var e=__values(n),r=e.next();!r.done;r=e.next()){var s=r.value,a=this.hashTable.get(s);a&&(a.delete(t),0===a.size&&(this.returnSetToPool(a),this.hashTable.delete(s)))}}catch(t){o={error:t}}finally{try{r&&!r.done&&(i=e.return)&&i.call(e)}finally{if(o)throw o.error}}this.objectTable.delete(t)}},t.prototype.clear=function(){var t,o;try{for(var i=__values(this.setPool),n=i.next();!n.done;n=i.next()){n.value.clear()}}catch(o){t={error:o}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(t)throw t.error}}this.hashTable.clear(),this.objectTable.clear()},t}();t.SpatialHash=o}(t.physics||(t.physics={}))}(gs||(gs={})),function(t){!function(o){var i=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.onInitialize=function(t,i){void 0===t&&(t=0),void 0===i&&(i=0),this.position=new o.Vector2(t,i)},i}(t.Component);o.Transform=i}(t.physics||(t.physics={}))}(gs||(gs={})),function(t){!function(t){var o=function(){function o(o,i){void 0===o&&(o=0),void 0===i&&(i=0),this.x=o instanceof t.FixedPoint?o:new t.FixedPoint(o),this.y=i instanceof t.FixedPoint?i:new t.FixedPoint(i)}return o.zero=function(){return new o},o.prototype.add=function(i){return new o(t.FixedPoint.add(this.x,i.x),t.FixedPoint.add(this.y,i.y))},o.prototype.sub=function(i){return new o(t.FixedPoint.sub(this.x,i.x),t.FixedPoint.sub(this.y,i.y))},o.prototype.mul=function(i){return new o(t.FixedPoint.mul(this.x,i),t.FixedPoint.mul(this.y,i))},o.prototype.div=function(i){return new o(t.FixedPoint.div(this.x,i),t.FixedPoint.div(this.y,i))},o.prototype.isZero=function(){return 0==this.x.toFloat()&&0==this.y.toFloat()},o.prototype.set=function(t,o){return this.x=t,this.y=o,this},o.prototype.setR=function(t){return this.x=t.x,this.y=t.y,this},o.prototype.length=function(){var o=t.FixedPoint.add(t.FixedPoint.mul(this.x,this.x),t.FixedPoint.mul(this.y,this.y));return t.FixedPoint.from(Math.sqrt(o.toFloat()))},o.prototype.lengthSquared=function(){return t.FixedPoint.add(t.FixedPoint.mul(this.x,this.x),t.FixedPoint.mul(this.y,this.y))},o.prototype.normalize=function(){var i=this.length();return new o(t.FixedPoint.div(this.x,i),t.FixedPoint.div(this.y,i))},o.prototype.dot=function(o){return t.FixedPoint.add(t.FixedPoint.mul(this.x,o.x),t.FixedPoint.mul(this.y,o.y))},o.prototype.cross=function(o){return t.FixedPoint.sub(t.FixedPoint.mul(this.x,o.y),t.FixedPoint.mul(this.y,o.x))},o.prototype.crossR=function(o){return t.FixedPoint.sub(this.x.mul(o),this.y.mul(o))},o.prototype.distanceTo=function(o){var i=t.FixedPoint.sub(this.x,o.x),n=t.FixedPoint.sub(this.y,o.y),e=t.FixedPoint.add(t.FixedPoint.mul(i,i),t.FixedPoint.mul(n,n));return t.FixedPoint.from(Math.sqrt(e.toFloat()))},o.prototype.perp=function(){return new o(this.y.negate(),this.x)},o.prototype.perpR=function(){return new o(this.y,this.x.negate())},o.prototype.lengthSq=function(){return this.x.mul(this.x).add(this.y.mul(this.y))},o.prototype.clamp=function(i,n){return new o(t.FixedPoint.clamp(this.x,i.x,n.x),t.FixedPoint.clamp(this.y,i.y,n.y))},o.prototype.negate=function(){return new o(this.x.negate(),this.y.negate())},o.negate=function(t){return t.x=t.x.negate(),t.y=t.y.negate(),t},o}();t.Vector2=o}(t.physics||(t.physics={}))}(gs||(gs={})),function(t){!function(t){var o=function(){function o(o,i){void 0===o&&(o=new t.FixedPoint(0,-9.81)),void 0===i&&(i=new t.FixedPoint(1/60)),this.name="PhysicsPlugin",this.gravity=o,this.timeStep=i}return o.prototype.onInit=function(o){o.systemManager.registerSystem(new t.CollisionResponseSystem(o.entityManager,1e3*this.timeStep.toFloat()))},o.prototype.onUpdate=function(t){},o}();t.World=o}(t.physics||(t.physics={}))}(gs||(gs={})),function(t){!function(o){var i=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.dependencies=[o.Transform],i.collidingEntities=new Set,i.onCollisionEnter=function(){},i.onCollisionStay=function(){},i.onCollisionExit=function(){},i}return __extends(i,t),Object.defineProperty(i.prototype,"transform",{get:function(){return null==this._transform&&(this._transform=this.entity.getComponent(o.Transform)),this._transform},enumerable:!0,configurable:!0}),i.prototype.getBounds=function(){return this._bounds.position=this.transform.position,this._bounds},i.prototype.setBounds=function(t){this._bounds=t},i.prototype.handleCollision=function(t){this.collidingEntities.has(t)?this.onCollisionStay(t):(this.collidingEntities.add(t),this.onCollisionEnter(t))},i.prototype.handleCollisionExit=function(t){this.collidingEntities.has(t)&&(this.collidingEntities.delete(t),this.onCollisionExit(t))},i.prototype.getCollisionNormal=function(t){var i=this.getBounds(),n=t.getBounds(),e=i.position.add(new o.Vector2(new o.FixedPoint(i.width.toFloat()/2),new o.FixedPoint(i.height.toFloat()/2))),r=n.position.add(new o.Vector2(new o.FixedPoint(n.width.toFloat()/2),new o.FixedPoint(n.height.toFloat()/2))).sub(e);return Math.abs(r.x.toFloat())>Math.abs(r.y.toFloat())?new o.Vector2(new o.FixedPoint(r.x.toFloat()>0?1:-1),new o.FixedPoint(0)):new o.Vector2(new o.FixedPoint(0),new o.FixedPoint(r.y.toFloat()>0?1:-1))},i.prototype.calculatePenetrationDepthAndNormal=function(t){return this.getBounds().calculatePenetrationDepthAndNormal(t.getBounds())},i.prototype.intersects=function(t){return this.getBounds().intersects(t.getBounds())},i.prototype.contains=function(t){return this.getBounds().contains(t.getBounds())},i}(t.Component);o.Collider=i}(t.physics||(t.physics={}))}(gs||(gs={})),function(t){!function(t){var o=function(o){function i(){return null!==o&&o.apply(this,arguments)||this}return __extends(i,o),i.prototype.onInitialize=function(o){this.size=o;var i=new t.BoxBounds(this.transform.position,this.size.width,this.size.height,this.entity);this.setBounds(i)},i}(t.Collider);t.BoxCollider=o}(t.physics||(t.physics={}))}(gs||(gs={})),function(t){!function(t){var o=function(o){function i(){return null!==o&&o.apply(this,arguments)||this}return __extends(i,o),i.prototype.onInitialize=function(o){this.radius=o;var i=new t.CircleBounds(this.transform.position,this.radius,this.entity);this.setBounds(i)},i}(t.Collider);t.CircleCollider=o}(t.physics||(t.physics={}))}(gs||(gs={})),function(t){!function(t){var o=function(t){function o(){return null!==t&&t.apply(this,arguments)||this}return __extends(o,t),o}(t.Collider);t.PolygonCollider=o}(t.physics||(t.physics={}))}(gs||(gs={})),function(t){!function(t){var o=function(){function o(t,o,i,n){this.position=t,this.width=o,this.height=i,this.entity=n}return o.prototype.intersects=function(o){var i=new t.IntersectionVisitor(o);return this.accept(i),i.getResult()},o.prototype.contains=function(o){var i=new t.ContainVisitor(o);return this.accept(i),i.getResult()},o.prototype.calculatePenetrationDepthAndNormal=function(o){var i=new t.CollisionResolver(o);return this.accept(i),i.getResult()},o}();t.AbstractBounds=o}(t.physics||(t.physics={}))}(gs||(gs={})),function(t){!function(t){var o=function(o){function i(i,n,e,r){var s=o.call(this,i,n,e,r)||this;return s._center=new t.Vector2(s.position.x.add(s.width.div(2)),s.position.y.add(s.height.div(2))),s._halfExtents=new t.Vector2(s.width.div(2),s.height.div(2)),s}return __extends(i,o),Object.defineProperty(i.prototype,"center",{get:function(){return this._center},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"halfExtents",{get:function(){return this._halfExtents},enumerable:!0,configurable:!0}),i.prototype.toPolygon=function(){var o=[this.position,new t.Vector2(this.position.x.add(this.width),this.position.y),new t.Vector2(this.position.x.add(this.width),this.position.y.add(this.height)),new t.Vector2(this.position.x,this.position.y.add(this.height))];return new t.PolygonBounds(this.position,o,this.entity)},i.prototype.project=function(o){var i,n,e=[this.position,this.position.add(new t.Vector2(this.width.toFloat(),0)),this.position.add(new t.Vector2(this.width.toFloat(),this.height.toFloat())),this.position.add(new t.Vector2(0,this.height.toFloat()))],r=1/0,s=-1/0;try{for(var a=__values(e),l=a.next();!l.done;l=a.next()){var h=l.value.dot(o).toFloat();r=Math.min(r,h),s=Math.max(s,h)}}catch(t){i={error:t}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return new t.Projection(r,s)},i.prototype.accept=function(t){t.visitBox(this)},i}(t.AbstractBounds);t.BoxBounds=o}(t.physics||(t.physics={}))}(gs||(gs={})),function(t){!function(t){var o=function(o){function i(t,i,n){var e=o.call(this,t,i.mul(2),i.mul(2),n)||this;return e.radius=i,e}return __extends(i,o),i.prototype.intersects=function(o){var i=new t.IntersectionVisitor(o);return this.accept(i),i.getResult()},i.prototype.contains=function(o){var i=new t.ContainVisitor(o);return this.accept(i),i.getResult()},i.prototype.accept=function(t){t.visitCircle(this)},i}(t.AbstractBounds);t.CircleBounds=o}(t.physics||(t.physics={}))}(gs||(gs={})),function(t){!function(t){var o=function(){function o(t){this.result={penetrationDepth:null,collisionNormal:null},this.other=t}return o.prototype.visitCircle=function(t){this.dispatchCircleCollision(t)},o.prototype.visitBox=function(t){this.dispatchBoxCollision(t)},o.prototype.visitPolygon=function(t){this.dispatchPolygonCollision(t)},o.prototype.dispatchCircleCollision=function(o){this.other instanceof t.CircleBounds?this.resolveCircleCircleCollision(o,this.other):this.other instanceof t.BoxBounds?this.resolveCircleBoxCollision(o,this.other):this.other instanceof t.PolygonBounds&&this.resolveCirclePolygonCollision(o,this.other)},o.prototype.dispatchBoxCollision=function(o){this.other instanceof t.CircleBounds?this.resolveCircleBoxCollision(this.other,o):this.other instanceof t.BoxBounds?this.resolveBoxBoxCollision(o,this.other):this.other instanceof t.PolygonBounds&&this.resolveBoxPolygonCollision(o,this.other)},o.prototype.dispatchPolygonCollision=function(o){this.other instanceof t.CircleBounds?this.resolveCirclePolygonCollision(this.other,o):this.other instanceof t.BoxBounds?this.resolveBoxPolygonCollision(this.other,o):this.other instanceof t.PolygonBounds&&this.resolvePolygonPolygonCollision(o,this.other)},o.prototype.resolveBoxBoxCollision=function(t,o){this.resolvePolygonPolygonCollision(t.toPolygon(),o.toPolygon())},o.prototype.resolveCircleBoxCollision=function(t,o){var i=t.position.sub(o.center),n=i.clamp(o.halfExtents.negate(),o.halfExtents),e=i.sub(n);if(!e.lengthSquared().gt(t.radius.mul(t.radius))){var r=e.normalize(),s=t.radius.sub(e.length());this.result={penetrationDepth:s,collisionNormal:r}}},o.prototype.resolveCirclePolygonCollision=function(o,i){for(var n,e,r=new t.FixedPoint(Number.MAX_VALUE),s=0;s<i.vertices.length;s++){var a=s+1==i.vertices.length?0:s+1,l=i.vertices[a].sub(i.vertices[s]),h=o.position.sub(i.vertices[s]).dot(l).div(l.lengthSquared());h=t.FixedPoint.clamp(h,0,1);var u=i.vertices[s].add(l.mul(h)),c=o.position.sub(u),d=c.lengthSquared();d.lt(r)&&(r=d,n=c.normalize(),e=o.radius.sub(d.sqrt()))}r.gt(o.radius.mul(o.radius))||(this.result={penetrationDepth:e,collisionNormal:n})},o.prototype.resolveBoxPolygonCollision=function(t,o){this.resolvePolygonPolygonCollision(t.toPolygon(),o)},o.prototype.resolveCircleCircleCollision=function(t,o){var i=t.position.sub(o.position).length();if(i<t.radius.add(o.radius)){var n=t.position.sub(o.position).normalize(),e=t.radius.add(o.radius).sub(i);this.result={penetrationDepth:e,collisionNormal:n}}},o.prototype.resolvePolygonPolygonCollision=function(o,i){var n,e,r,s,a,l,h,u=new t.FixedPoint(Number.MAX_VALUE);try{for(var c=__values([o,i]),d=c.next();!d.done;d=c.next())for(var p=d.value,f=0;f<p.vertices.length;f++){var y=p.vertices[f],v=p.vertices[f+1==p.vertices.length?0:f+1],x=new t.Vector2(v.y.sub(y.y),y.x.sub(v.x)).normalize(),g=null,m=null;try{for(var w=__values(o.vertices),F=w.next();!F.done;F=w.next()){var P=F.value,_=x.dot(P);g=null===g?_:t.FixedPoint.min(g,_),m=null===m?_:t.FixedPoint.max(m,_)}}catch(t){r={error:t}}finally{try{F&&!F.done&&(s=w.return)&&s.call(w)}finally{if(r)throw r.error}}var b=null,B=null;try{for(var C=__values(i.vertices),M=C.next();!M.done;M=C.next()){P=M.value,_=x.dot(P);b=null===b?_:t.FixedPoint.min(b,_),B=null===B?_:t.FixedPoint.max(B,_)}}catch(t){a={error:t}}finally{try{M&&!M.done&&(l=C.return)&&l.call(C)}finally{if(a)throw a.error}}var V=t.FixedPoint.min(m,B).sub(t.FixedPoint.max(g,b));if(V.lt(0))return;V.lt(u)&&(u=V,h=x)}}catch(t){n={error:t}}finally{try{d&&!d.done&&(e=c.return)&&e.call(c)}finally{if(n)throw n.error}}this.result={penetrationDepth:u,collisionNormal:h}},o.prototype.getResult=function(){return this.result},o}();t.CollisionResolver=o}(t.physics||(t.physics={}))}(gs||(gs={})),function(t){!function(t){var o=function(){function o(t){this.other=t,this.result=!1}return o.prototype.visitBox=function(o){if(this.other instanceof t.BoxBounds){var i=this.other;this.result=o.position.x.toFloat()<=i.position.x.toFloat()&&o.position.y.toFloat()<=i.position.y.toFloat()&&o.position.x.toFloat()+o.width.toFloat()>=i.position.x.toFloat()+i.width.toFloat()&&o.position.y.toFloat()+o.height.toFloat()>=i.position.y.toFloat()+i.height.toFloat()}else if(this.other instanceof t.CircleBounds){var n=this.other,e=new t.BoxBounds(n.position,n.radius.mul(2),n.radius.mul(2),n.entity);this.result=o.position.x.toFloat()<=e.position.x.toFloat()&&o.position.y.toFloat()<=e.position.y.toFloat()&&o.position.x.toFloat()+o.width.toFloat()>=e.position.x.toFloat()+e.width.toFloat()&&o.position.y.toFloat()+o.height.toFloat()>=e.position.y.toFloat()+e.height.toFloat()}},o.prototype.visitCircle=function(o){if(this.other instanceof t.CircleBounds){var i=this.other,n=o.position.x.toFloat()-i.position.x.toFloat(),e=o.position.y.toFloat()-i.position.y.toFloat(),r=Math.sqrt(n*n+e*e);this.result=r+i.radius.toFloat()<=o.radius.toFloat()}else if(this.other instanceof t.BoxBounds){var s=this.other,a=Math.sqrt(Math.pow(s.width.toFloat()/2,2)+Math.pow(s.height.toFloat()/2,2)),l=new t.CircleBounds(s.position.add(new t.Vector2(s.width.div(2),s.height.div(2))),new t.FixedPoint(a),s.entity);n=o.position.x.toFloat()-l.position.x.toFloat(),e=o.position.y.toFloat()-l.position.y.toFloat(),r=Math.sqrt(n*n+e*e);this.result=r+l.radius.toFloat()<=o.radius.toFloat()}},o.prototype.visitPolygon=function(o){if(this.other instanceof t.PolygonBounds){var i=this.other;this.result=i.vertices.every(function(t){return o.containsPoint(t)})}},o.prototype.getResult=function(){return this.result},o}();t.ContainVisitor=o}(t.physics||(t.physics={}))}(gs||(gs={})),function(t){!function(t){var o=function(){function o(t){this.other=t,this.result=!1}return o.prototype.visitBox=function(o){if(this.other instanceof t.BoxBounds){var i=this.other;this.result=!(o.position.x.add(o.width).lt(i.position.x)||i.position.x.add(i.width).lt(o.position.x)||o.position.y.add(o.height).lt(i.position.y)||i.position.y.add(i.height).lt(o.position.y))}else this.other instanceof t.CircleBounds?this.result=this.intersectsBoxCircle(o,this.other):this.other instanceof t.PolygonBounds&&(this.result=this.intersectsPolygonBox(this.other,o))},o.prototype.visitCircle=function(o){if(this.other instanceof t.CircleBounds){var i=this.other,n=o.position.x.toFloat()-i.position.x.toFloat(),e=o.position.y.toFloat()-i.position.y.toFloat(),r=Math.sqrt(n*n+e*e);this.result=r<o.radius.toFloat()+i.radius.toFloat()}else this.other instanceof t.BoxBounds?this.result=this.intersectsBoxCircle(this.other,o):this.other instanceof t.PolygonBounds&&(this.result=this.intersectsPolygonCircle(this.other,o))},o.prototype.visitPolygon=function(o){if(this.other instanceof t.PolygonBounds){var i=this.other,n=new t.PolygonCollisionDetector(o,i);this.result=n.gjk()}else this.other instanceof t.CircleBounds?this.result=this.intersectsPolygonCircle(o,this.other):this.other instanceof t.BoxBounds&&(this.result=this.intersectsPolygonBox(o,this.other))},o.prototype.intersectsBoxCircle=function(t,o){var i=o.position.x.sub(t.position.x.add(t.width.div(2))).abs(),n=o.position.y.sub(t.position.y.add(t.height.div(2))).abs();return!i.gte(t.width.div(2).add(o.radius))&&(!n.gte(t.height.div(2).add(o.radius))&&(!!i.lte(t.width.div(2))||(!!n.lte(t.height.div(2))||i.sub(t.width.div(2)).pow(2).add(n.sub(t.height.div(2)).pow(2)).lte(o.radius.pow(2)))))},o.prototype.intersectsPolygonCircle=function(t,o){var i,n,e=1/0,r=null;try{for(var s=__values(t.vertices),a=s.next();!a.done;a=s.next()){var l=a.value,h=l.sub(o.position).lengthSq().toFloat();h<e&&(e=h,r=l)}}catch(t){i={error:t}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return!!r&&r.sub(o.position).lengthSq().toFloat()<=Math.pow(o.radius.toFloat(),2)},o.prototype.intersectsPolygonBox=function(o,i){for(var n,e,r=[new t.Vector2(1,0),new t.Vector2(0,1),new t.Vector2(-1,0),new t.Vector2(0,-1)],s=0;s<o.vertices.length;s++){var a=o.vertices[s],l=o.vertices[(s+1)%o.vertices.length].sub(a);r.push(l.normalize().perp())}try{for(var h=__values(r),u=h.next();!u.done;u=h.next()){var c=u.value,d=o.project(c),p=i.project(c);if(!d.overlaps(p))return!1}}catch(t){n={error:t}}finally{try{u&&!u.done&&(e=h.return)&&e.call(h)}finally{if(n)throw n.error}}return!0},o.prototype.getResult=function(){return this.result},o}();t.IntersectionVisitor=o}(t.physics||(t.physics={}))}(gs||(gs={})),function(t){!function(t){var o=function(o){function i(t,n,e){var r=o.call(this,t,i.getWidth(n),i.getHeight(n),e)||this;return r._vertices=n,r}return __extends(i,o),Object.defineProperty(i.prototype,"vertices",{get:function(){return this._vertices},enumerable:!0,configurable:!0}),i.prototype.getWidth=function(){var o,i,n=1/0,e=-1/0;try{for(var r=__values(this._vertices),s=r.next();!s.done;s=r.next()){var a=s.value.x.toFloat();n=Math.min(n,a),e=Math.max(e,a)}}catch(t){o={error:t}}finally{try{s&&!s.done&&(i=r.return)&&i.call(r)}finally{if(o)throw o.error}}return new t.FixedPoint(e-n)},i.prototype.getHeight=function(){var o,i,n=1/0,e=-1/0;try{for(var r=__values(this._vertices),s=r.next();!s.done;s=r.next()){var a=s.value.y.toFloat();n=Math.min(n,a),e=Math.max(e,a)}}catch(t){o={error:t}}finally{try{s&&!s.done&&(i=r.return)&&i.call(r)}finally{if(o)throw o.error}}return new t.FixedPoint(e-n)},i.getWidth=function(o){var i,n,e=1/0,r=-1/0;try{for(var s=__values(o),a=s.next();!a.done;a=s.next()){var l=a.value.x.toFloat();e=Math.min(e,l),r=Math.max(r,l)}}catch(t){i={error:t}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return new t.FixedPoint(r-e)},i.getHeight=function(o){var i,n,e=1/0,r=-1/0;try{for(var s=__values(o),a=s.next();!a.done;a=s.next()){var l=a.value.y.toFloat();e=Math.min(e,l),r=Math.max(r,l)}}catch(t){i={error:t}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return new t.FixedPoint(r-e)},i.prototype.getFarthestPointInDirection=function(t){var o,i,n=-1/0,e=null;try{for(var r=__values(this._vertices),s=r.next();!s.done;s=r.next()){var a=s.value,l=a.dot(t).toFloat();l>n&&(n=l,e=a)}}catch(t){o={error:t}}finally{try{s&&!s.done&&(i=r.return)&&i.call(r)}finally{if(o)throw o.error}}return e},i.prototype.project=function(o){var i,n,e=1/0,r=-1/0;try{for(var s=__values(this._vertices),a=s.next();!a.done;a=s.next()){var l=a.value.dot(o).toFloat();e=Math.min(e,l),r=Math.max(r,l)}}catch(t){i={error:t}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return new t.Projection(e,r)},i.prototype.containsPoint=function(t){for(var o=!1,i=t.x.toFloat(),n=t.y.toFloat(),e=0,r=this._vertices.length-1;e<this._vertices.length;r=e++){var s=this._vertices[e].x.toFloat(),a=this._vertices[e].y.toFloat(),l=this._vertices[r].x.toFloat(),h=this._vertices[r].y.toFloat();a>n!=h>n&&i<(l-s)*(n-a)/(h-a)+s&&(o=!o)}return o},i.prototype.intersects=function(o){var i=new t.IntersectionVisitor(o);return this.accept(i),i.getResult()},i.prototype.contains=function(o){var i=new t.ContainVisitor(o);return this.accept(i),i.getResult()},i.prototype.accept=function(t){t.visitPolygon(this)},i}(t.AbstractBounds);t.PolygonBounds=o}(t.physics||(t.physics={}))}(gs||(gs={}));